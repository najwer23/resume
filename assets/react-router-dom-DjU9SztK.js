import{r,R as z}from"./react-DZLWSh8C.js";import{R as B}from"./react-dom-CcTSMvaW.js";import{m as Y,N as J,u as G,a as W,b as q,D as k,c as j,R as Q,d as X}from"./react-router-D9E8enyN.js";import{b as Z,d as $,E as ee,i as A,s as te}from"./@remix-run-DMaHLbMN.js";/**
 * React Router DOM v6.23.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function T(){return T=Object.assign?Object.assign.bind():function(t){for(var n=1;n<arguments.length;n++){var e=arguments[n];for(var s in e)Object.prototype.hasOwnProperty.call(e,s)&&(t[s]=e[s])}return t},T.apply(this,arguments)}const ne="6";try{window.__reactRouterVersion=ne}catch{}function Re(t,n){return Z({basename:void 0,future:T({},void 0,{v7_prependBasename:!0}),history:$({window:void 0}),hydrationData:re(),routes:t,mapRouteProperties:Y,unstable_dataStrategy:void 0,window:void 0}).initialize()}function re(){var t;let n=(t=window)==null?void 0:t.__staticRouterHydrationData;return n&&n.errors&&(n=T({},n,{errors:oe(n.errors)})),n}function oe(t){if(!t)return null;let n=Object.entries(t),e={};for(let[s,o]of n)if(o&&o.__type==="RouteErrorResponse")e[s]=new ee(o.status,o.statusText,o.data,o.internal===!0);else if(o&&o.__type==="Error"){if(o.__subType){let u=window[o.__subType];if(typeof u=="function")try{let l=new u(o.message);l.stack="",e[s]=l}catch{}}if(e[s]==null){let u=new Error(o.message);u.stack="",e[s]=u}}else e[s]=o;return e}const se=r.createContext({isTransitioning:!1}),ie=r.createContext(new Map),ae="startTransition",N=z[ae],le="flushSync",V=B[le];function ue(t){N?N(t):t()}function g(t){V?V(t):t()}class ce{constructor(){this.status="pending",this.promise=new Promise((n,e)=>{this.resolve=s=>{this.status==="pending"&&(this.status="resolved",n(s))},this.reject=s=>{this.status==="pending"&&(this.status="rejected",e(s))}})}}function ge(t){let{fallbackElement:n,router:e,future:s}=t,[o,u]=r.useState(e.state),[l,c]=r.useState(),[v,p]=r.useState({isTransitioning:!1}),[i,S]=r.useState(),[f,y]=r.useState(),[R,P]=r.useState(),E=r.useRef(new Map),{v7_startTransition:I}=s||{},L=r.useCallback(a=>{I?ue(a):a()},[I]),U=r.useCallback((a,h)=>{let{deletedFetchers:d,unstable_flushSync:F,unstable_viewTransitionOpts:m}=h;d.forEach(w=>E.current.delete(w)),a.fetchers.forEach((w,M)=>{w.data!==void 0&&E.current.set(M,w.data)});let K=e.window==null||typeof e.window.document.startViewTransition!="function";if(!m||K){F?g(()=>u(a)):L(()=>u(a));return}if(F){g(()=>{f&&(i&&i.resolve(),f.skipTransition()),p({isTransitioning:!0,flushSync:!0,currentLocation:m.currentLocation,nextLocation:m.nextLocation})});let w=e.window.document.startViewTransition(()=>{g(()=>u(a))});w.finished.finally(()=>{g(()=>{S(void 0),y(void 0),c(void 0),p({isTransitioning:!1})})}),g(()=>y(w));return}f?(i&&i.resolve(),f.skipTransition(),P({state:a,currentLocation:m.currentLocation,nextLocation:m.nextLocation})):(c(a),p({isTransitioning:!0,flushSync:!1,currentLocation:m.currentLocation,nextLocation:m.nextLocation}))},[e.window,f,i,E,L]);r.useLayoutEffect(()=>e.subscribe(U),[e,U]),r.useEffect(()=>{v.isTransitioning&&!v.flushSync&&S(new ce)},[v]),r.useEffect(()=>{if(i&&l&&e.window){let a=l,h=i.promise,d=e.window.document.startViewTransition(async()=>{L(()=>u(a)),await h});d.finished.finally(()=>{S(void 0),y(void 0),c(void 0),p({isTransitioning:!1})}),y(d)}},[L,l,i,e.window]),r.useEffect(()=>{i&&l&&o.location.key===l.location.key&&i.resolve()},[i,f,o.location,l]),r.useEffect(()=>{!v.isTransitioning&&R&&(c(R.state),p({isTransitioning:!0,flushSync:!1,currentLocation:R.currentLocation,nextLocation:R.nextLocation}),P(void 0))},[v.isTransitioning,R]),r.useEffect(()=>{},[]);let x=r.useMemo(()=>({createHref:e.createHref,encodeLocation:e.encodeLocation,go:a=>e.navigate(a),push:(a,h,d)=>e.navigate(a,{state:h,preventScrollReset:d==null?void 0:d.preventScrollReset}),replace:(a,h,d)=>e.navigate(a,{replace:!0,state:h,preventScrollReset:d==null?void 0:d.preventScrollReset})}),[e]),b=e.basename||"/",H=r.useMemo(()=>({router:e,navigator:x,static:!1,basename:b}),[e,x,b]);return r.createElement(r.Fragment,null,r.createElement(k.Provider,{value:H},r.createElement(j.Provider,{value:o},r.createElement(ie.Provider,{value:E.current},r.createElement(se.Provider,{value:v},r.createElement(Q,{basename:b,location:o.location,navigationType:o.historyAction,navigator:x,future:{v7_relativeSplatPath:e.future.v7_relativeSplatPath}},o.initialized||e.future.v7_partialHydration?r.createElement(fe,{routes:e.routes,future:e.future,state:o}):n))))),null)}function fe(t){let{routes:n,future:e,state:s}=t;return X(n,void 0,s,e)}function Te(t){let{getKey:n,storageKey:e}=t;return pe({getKey:n,storageKey:e}),null}var C;(function(t){t.UseScrollRestoration="useScrollRestoration",t.UseSubmit="useSubmit",t.UseSubmitFetcher="useSubmitFetcher",t.UseFetcher="useFetcher",t.useViewTransitionState="useViewTransitionState"})(C||(C={}));var O;(function(t){t.UseFetcher="useFetcher",t.UseFetchers="useFetchers",t.UseScrollRestoration="useScrollRestoration"})(O||(O={}));function de(t){let n=r.useContext(k);return n||A(!1),n}function ve(t){let n=r.useContext(j);return n||A(!1),n}const D="react-router-scroll-positions";let _={};function pe(t){let{getKey:n,storageKey:e}=t===void 0?{}:t,{router:s}=de(C.UseScrollRestoration),{restoreScrollPosition:o,preventScrollReset:u}=ve(O.UseScrollRestoration),{basename:l}=r.useContext(J),c=G(),v=W(),p=q();r.useEffect(()=>(window.history.scrollRestoration="manual",()=>{window.history.scrollRestoration="auto"}),[]),he(r.useCallback(()=>{if(p.state==="idle"){let i=(n?n(c,v):null)||c.key;_[i]=window.scrollY}try{sessionStorage.setItem(e||D,JSON.stringify(_))}catch{}window.history.scrollRestoration="auto"},[e,n,p.state,c,v])),typeof document<"u"&&(r.useLayoutEffect(()=>{try{let i=sessionStorage.getItem(e||D);i&&(_=JSON.parse(i))}catch{}},[e]),r.useLayoutEffect(()=>{let i=n&&l!=="/"?(f,y)=>n(T({},f,{pathname:te(f.pathname,l)||f.pathname}),y):n,S=s==null?void 0:s.enableScrollRestoration(_,()=>window.scrollY,i);return()=>S&&S()},[s,l,n]),r.useLayoutEffect(()=>{if(o!==!1){if(typeof o=="number"){window.scrollTo(0,o);return}if(c.hash){let i=document.getElementById(decodeURIComponent(c.hash.slice(1)));if(i){i.scrollIntoView();return}}u!==!0&&window.scrollTo(0,0)}},[c,o,u]))}function he(t,n){let{capture:e}={};r.useEffect(()=>{let s=e!=null?{capture:e}:void 0;return window.addEventListener("pagehide",t,s),()=>{window.removeEventListener("pagehide",t,s)}},[t,e])}export{ge as R,Te as S,Re as c};
