import{r,R as z}from"./react-rOHNuZJI.js";import{R as B}from"./react-dom-DAayx7oH.js";import{m as Y,N as J,u as G,a as W,b as q,D as k,c as j,R as Q,d as X}from"./react-router-9WkweFe5.js";import{b as Z,d as $,E as ee,i as A,s as te}from"./@remix-run-BUgIud2A.js";/**
 * React Router DOM v6.22.3
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function T(){return T=Object.assign?Object.assign.bind():function(n){for(var t=1;t<arguments.length;t++){var e=arguments[t];for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(n[o]=e[o])}return n},T.apply(this,arguments)}const ne="6";try{window.__reactRouterVersion=ne}catch{}function Re(n,t){return Z({basename:t==null?void 0:t.basename,future:T({},t==null?void 0:t.future,{v7_prependBasename:!0}),history:$({window:t==null?void 0:t.window}),hydrationData:(t==null?void 0:t.hydrationData)||re(),routes:n,mapRouteProperties:Y,window:t==null?void 0:t.window}).initialize()}function re(){var n;let t=(n=window)==null?void 0:n.__staticRouterHydrationData;return t&&t.errors&&(t=T({},t,{errors:ie(t.errors)})),t}function ie(n){if(!n)return null;let t=Object.entries(n),e={};for(let[o,i]of t)if(i&&i.__type==="RouteErrorResponse")e[o]=new ee(i.status,i.statusText,i.data,i.internal===!0);else if(i&&i.__type==="Error"){if(i.__subType){let u=window[i.__subType];if(typeof u=="function")try{let l=new u(i.message);l.stack="",e[o]=l}catch{}}if(e[o]==null){let u=new Error(i.message);u.stack="",e[o]=u}}else e[o]=i;return e}const oe=r.createContext({isTransitioning:!1}),se=r.createContext(new Map),ae="startTransition",N=z[ae],le="flushSync",D=B[le];function ue(n){N?N(n):n()}function g(n){D?D(n):n()}class ce{constructor(){this.status="pending",this.promise=new Promise((t,e)=>{this.resolve=o=>{this.status==="pending"&&(this.status="resolved",t(o))},this.reject=o=>{this.status==="pending"&&(this.status="rejected",e(o))}})}}function ge(n){let{fallbackElement:t,router:e,future:o}=n,[i,u]=r.useState(e.state),[l,c]=r.useState(),[v,h]=r.useState({isTransitioning:!1}),[s,S]=r.useState(),[f,y]=r.useState(),[R,P]=r.useState(),E=r.useRef(new Map),{v7_startTransition:I}=o||{},L=r.useCallback(a=>{I?ue(a):a()},[I]),U=r.useCallback((a,m)=>{let{deletedFetchers:d,unstable_flushSync:F,unstable_viewTransitionOpts:w}=m;d.forEach(p=>E.current.delete(p)),a.fetchers.forEach((p,M)=>{p.data!==void 0&&E.current.set(M,p.data)});let K=e.window==null||typeof e.window.document.startViewTransition!="function";if(!w||K){F?g(()=>u(a)):L(()=>u(a));return}if(F){g(()=>{f&&(s&&s.resolve(),f.skipTransition()),h({isTransitioning:!0,flushSync:!0,currentLocation:w.currentLocation,nextLocation:w.nextLocation})});let p=e.window.document.startViewTransition(()=>{g(()=>u(a))});p.finished.finally(()=>{g(()=>{S(void 0),y(void 0),c(void 0),h({isTransitioning:!1})})}),g(()=>y(p));return}f?(s&&s.resolve(),f.skipTransition(),P({state:a,currentLocation:w.currentLocation,nextLocation:w.nextLocation})):(c(a),h({isTransitioning:!0,flushSync:!1,currentLocation:w.currentLocation,nextLocation:w.nextLocation}))},[e.window,f,s,E,L]);r.useLayoutEffect(()=>e.subscribe(U),[e,U]),r.useEffect(()=>{v.isTransitioning&&!v.flushSync&&S(new ce)},[v]),r.useEffect(()=>{if(s&&l&&e.window){let a=l,m=s.promise,d=e.window.document.startViewTransition(async()=>{L(()=>u(a)),await m});d.finished.finally(()=>{S(void 0),y(void 0),c(void 0),h({isTransitioning:!1})}),y(d)}},[L,l,s,e.window]),r.useEffect(()=>{s&&l&&i.location.key===l.location.key&&s.resolve()},[s,f,i.location,l]),r.useEffect(()=>{!v.isTransitioning&&R&&(c(R.state),h({isTransitioning:!0,flushSync:!1,currentLocation:R.currentLocation,nextLocation:R.nextLocation}),P(void 0))},[v.isTransitioning,R]),r.useEffect(()=>{},[]);let _=r.useMemo(()=>({createHref:e.createHref,encodeLocation:e.encodeLocation,go:a=>e.navigate(a),push:(a,m,d)=>e.navigate(a,{state:m,preventScrollReset:d==null?void 0:d.preventScrollReset}),replace:(a,m,d)=>e.navigate(a,{replace:!0,state:m,preventScrollReset:d==null?void 0:d.preventScrollReset})}),[e]),b=e.basename||"/",H=r.useMemo(()=>({router:e,navigator:_,static:!1,basename:b}),[e,_,b]);return r.createElement(r.Fragment,null,r.createElement(k.Provider,{value:H},r.createElement(j.Provider,{value:i},r.createElement(se.Provider,{value:E.current},r.createElement(oe.Provider,{value:v},r.createElement(Q,{basename:b,location:i.location,navigationType:i.historyAction,navigator:_,future:{v7_relativeSplatPath:e.future.v7_relativeSplatPath}},i.initialized||e.future.v7_partialHydration?r.createElement(fe,{routes:e.routes,future:e.future,state:i}):t))))),null)}function fe(n){let{routes:t,future:e,state:o}=n;return X(t,void 0,o,e)}function Te(n){let{getKey:t,storageKey:e}=n;return he({getKey:t,storageKey:e}),null}var C;(function(n){n.UseScrollRestoration="useScrollRestoration",n.UseSubmit="useSubmit",n.UseSubmitFetcher="useSubmitFetcher",n.UseFetcher="useFetcher",n.useViewTransitionState="useViewTransitionState"})(C||(C={}));var O;(function(n){n.UseFetcher="useFetcher",n.UseFetchers="useFetchers",n.UseScrollRestoration="useScrollRestoration"})(O||(O={}));function de(n){let t=r.useContext(k);return t||A(!1),t}function ve(n){let t=r.useContext(j);return t||A(!1),t}const V="react-router-scroll-positions";let x={};function he(n){let{getKey:t,storageKey:e}=n===void 0?{}:n,{router:o}=de(C.UseScrollRestoration),{restoreScrollPosition:i,preventScrollReset:u}=ve(O.UseScrollRestoration),{basename:l}=r.useContext(J),c=G(),v=W(),h=q();r.useEffect(()=>(window.history.scrollRestoration="manual",()=>{window.history.scrollRestoration="auto"}),[]),me(r.useCallback(()=>{if(h.state==="idle"){let s=(t?t(c,v):null)||c.key;x[s]=window.scrollY}try{sessionStorage.setItem(e||V,JSON.stringify(x))}catch{}window.history.scrollRestoration="auto"},[e,t,h.state,c,v])),typeof document<"u"&&(r.useLayoutEffect(()=>{try{let s=sessionStorage.getItem(e||V);s&&(x=JSON.parse(s))}catch{}},[e]),r.useLayoutEffect(()=>{let s=t&&l!=="/"?(f,y)=>t(T({},f,{pathname:te(f.pathname,l)||f.pathname}),y):t,S=o==null?void 0:o.enableScrollRestoration(x,()=>window.scrollY,s);return()=>S&&S()},[o,l,t]),r.useLayoutEffect(()=>{if(i!==!1){if(typeof i=="number"){window.scrollTo(0,i);return}if(c.hash){let s=document.getElementById(decodeURIComponent(c.hash.slice(1)));if(s){s.scrollIntoView();return}}u!==!0&&window.scrollTo(0,0)}},[c,i,u]))}function me(n,t){let{capture:e}=t||{};r.useEffect(()=>{let o=e!=null?{capture:e}:void 0;return window.addEventListener("pagehide",n,o),()=>{window.removeEventListener("pagehide",n,o)}},[n,e])}export{ge as R,Te as S,Re as c};
